## CHAPTER 3. 애그리거트(_Aggregate_)

> [DDD Start! 도메인 주도 설계 구현과 핵심 개념 익히기 - 최범균] 학습 후 기록

> 1. 애그리거트<br>
> 2. 애그리거트 루트와 역할<br>
  > 2-1. 도메인 규칙과 일관성<br>
  > 2-2. 애그리거트 루트의 기능 구현<br>
  > 2-3. 트랜잭션 범위<br>
> 3. 애그리거트와 리포지터리<br>
> 4. ID를 이용한 애그리거트 참조<br>
  > 4-1. ID를 이용한 참조와 조회 성능


## 1. 애그리거트

&nbsp;백 개 이상의 테이블을 한 장의 ERD에 모두 표시하면 개별 테이블 간의 관계를 파악하느라 큰 틀에서 데이터 구조를 이해하는데 어려움을 겪게 되는 것처럼,
<ins>도메인 객체 모델이 복잡해지면 개별 구성요소 위주로 모델을 이해하게 되고 전반적인 구조나 큰 수준에서 도메인 간의 관계를 파악하기 어려워진다.</ins>

&nbsp;<ins>주요 도메인 개념 간의 관계를 파악하기 어렵다는 것은 곧 코드를 변경하고 확장하는 것이 어려워진다는 것을 의미한다.</ins>
상위 수준에서 모델이 어떻게 엮여 있는지 알아야 전체 모델을 망가뜨리지 않으면서 추가 요구사항을 모델에 반영할 수 있는데 세부적인 모델만 이해한 상태로 코드를 수정하기가 두렵기 때문에 코드 변경을 최대한 회피하는 쪽으로 요구사항을 협의하게 된다.

&nbsp;<ins>복잡한 도메인을 이해하고 관리하기 쉬운 단위로 만들려면 상위 수준에서 모델을 조망할 수 있는 방법이 필요한데,</ins> 그 방법이 바로 **_애그리거트_** 이다.

&nbsp;애그리거트는 관련된 객체를 하나의 군으로 묶어주는데, 수많은 객체를 애그리거트로 묶어서 바라보면 좀 더 상위 수준에서 도메인 모델 간의 관계를 파악할 수 있다.

<img src="https://github.com/ro117-youshin/TIL/blob/main/SystemDesign/img/models_at_individual_object_level.png"/>

&nbsp; 동일한 모델이지만 애그리거트를 사용함으로써 모델 간의 관계를 개별 모델 수준뿐만 아니라 상위 수준에서도 이해할 수 있게 된다.

<img src="https://github.com/ro117-youshin/TIL/blob/main/SystemDesign/img/models_at_aggregate_level.png"/>

&nbsp;애그리거트는 모델을 잘 이해하게 해줄 뿐만 아니라 <ins>일관성을 관리하는 기준이 된다.</ins>
<ins>일관성을 관리하기 때문에 복잡한 도메인을 단순한 구조로 만들어주고, 복잡도가 낮아지는 만큼 도메인 기능을 확장하고 변경하는데 필요한 노력(개발 시간)도 줄어든다.</ins>

&nbsp;<ins>한 애그리거트에 속한 객체는 유사하거나 동일한 라이프사이클을 갖는다.</ins> 
예를 들어, 주문 애그리거트를 만들려면 `Order`, `OrderLine`, `Orderer`와 같은 관련 객체를 함께 생성해야 한다.
`Order`를 생성했는데 `ShippingInfo`를 생성하지 않았거나 `ShippingInfo`를 생성했는데 `Orderer`를 생성하지 않는 경우는 없다.
도메인 규칙에 따라 최초 주문 시점에 일부 객체를 만들 필요가 없는 경우도 있지만 <ins>애그리거트에 속한 구성요소는 대부분 함께 생성하고 함께 제거한다.</ins>

---

## 2. 애그리거트 루트와 역할

---

## 3. 애그리거트와 리포지터리

---

## 4. ID를 이용한 애그리거트 참조

